<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Begin Jekyll SEO tag v2.8.0 -->
  <title>Final Icyption 2020 | Abdullah</title>
  <meta name="generator" content="Jekyll v4.3.2" />
  <meta property="og:title" content="Final Icyption 2020" />
  <meta property="og:locale" content="en_US" />
  <link rel="canonical" href="/2020/08/07/final-icyption-2020.html" />
  <meta property="og:url" content="/2020/08/07/final-icyption-2020.html" />
  <meta property="og:site_name" content="Abdullah" />
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2020-08-07T15:57:28+07:00" />
  <meta name="twitter:card" content="summary" />
  <meta property="twitter:title" content="Final Icyption 2020" />

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "dateModified": "2020-08-07T15:57:28+07:00",
      "datePublished": "2020-08-07T15:57:28+07:00",
      "headline": "Final Icyption 2020",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "/2020/08/07/final-icyption-2020.html"
      },
      "url": "/2020/08/07/final-icyption-2020.html"
    }
  </script>
  <!-- End Jekyll SEO tag -->
  <link rel="stylesheet" href="/assets/main.custom.css" />
  <link
    type="application/atom+xml"
    rel="alternate"
    href="http://localhost:4000/feed.xml"
    title="Final Icyption 2020"
  />
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Abdullah</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Final Icyption 2020</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-08-07T15:57:28+07:00" itemprop="datePublished">Aug 7, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Ini merupakan kompetisi CTF pertama yang saya ikuti, dan ini merupakan sebuah kickstart dan abuse untuk saya bahwa saya dapat berkontribusi di bidang ini. Special thanks to bl33dz yang telah mengundang saya untuk join ke tim nya (yang sebelumnya tim ini memiliki 3 anggota, karena sudah lulus satu diganti saya wkwk).</p>

<p><img src="/assets/icyp-final/scoreboard.png" alt="scoreboard" /></p>

<p>Yaaps, thats look like it. Kami menjuarai event tersebut, yeay. Tapi sayang, beasiswa hanya 1 untuk ketua tim, sad :’(</p>

<h2 id="love-on-the-weekend">Love On The Weekend</h2>

<p>Diberikan sebuah audio file yang bernama love on the weekend.mp3. Cek detail informasi file dengan exiftool didapat flag pada metadata Lyrics.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>exiftool love<span class="se">\ </span>on<span class="se">\ </span>the<span class="se">\ </span>weekend.mp3 | <span class="nb">grep</span> <span class="s1">'icyption{.*}'</span>
<span class="o">[</span>... REDACTED ...]
Love on the weekend icyption<span class="o">{</span>Do_y0u_l1k3_J0hn_May3r<span class="o">}</span><span class="nb">.</span>
<span class="o">[</span>... REDACTED ...]
</code></pre></div></div>

<h3 id="flag">Flag</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>icyption{Do_y0u_l1k3_J0hn_May3r}
</code></pre></div></div>

<h2 id="bitcoin-make-you-rich">Bitcoin Make You Rich</h2>

<p>Diberikan teks yang telah diencode yaitu sebagai berikut.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>J8pRND46rbHKmPuz4zWBNaWYzuo8uP6Kit4eFCnCgjGP7JWe8e9CVaK2LitS7CmeQdcCueM
</code></pre></div></div>

<p>Sempat stuck beberapa jam, karena saya kira base85 yang ternyata base58. Decode dengan base58 2 kali dan didapatkan flag.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'J8pRND46rbHKmPuz4zWBNaWYzuo8uP6Kit4eFCnCgjGP7JWe8e9CVaK2LitS7CmeQdcCueM'</span> | base58 <span class="nt">-d</span> | base58 <span class="nt">-d</span>
icyption<span class="o">{</span>satoshi_nakamoto_create_this<span class="o">}</span>
</code></pre></div></div>

<h3 id="flag-1">Flag</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>icyption{satoshi_nakamoto_create_this}
</code></pre></div></div>

<h2 id="something-wrong-with-this-drive">Something Wrong With This Drive</h2>

<p>Diberikan sebuah file data.img dimana command file pada linux tidak dapat mengetahui informasi file data.img yang menandakan file tersebut corrupt.</p>

<p>Fix file tersebut dengan e2fsck dan file berhasil diperbaiki.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>file data.img 
data.img: Linux rev 1.0 ext2 filesystem data, <span class="nv">UUID</span><span class="o">=</span>6fdb6fa9-bc9c-4970-a0be-8ad1de6ea848 <span class="o">(</span>large files<span class="o">)</span>
</code></pre></div></div>

<p>Mount, dan didapatkan file gambar yang memuat flag.</p>

<p><img src="/assets/icyp-final/something-flag.jpg" alt="something-flag" /></p>

<h3 id="flag-2">Flag</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>icyption{f1n4lly_y0u_f1nd_m3}
</code></pre></div></div>

<h2 id="wonderful-painting">Wonderful Painting</h2>

<p>Diberikan file gambar bernama blahblah.jpg. Cek stereogram dengan stegsolve didapatkan flag tetapi sulit untuk dibaca. Cari tools online, didapatkan pada https://magiceye.ecksdee.co.uk/. Upload gambar dan geser-geser didapatkan flag seperti nama tim saya :)</p>

<p><img src="/assets/icyp-final/wonderfull-flag.png" alt="wonderfull-flag" /></p>

<h3 id="flag-3">Flag</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>icyption{S3m0g4_K4mi_M3n4ng}
</code></pre></div></div>

<h2 id="sniff-sniff">Sniff Sniff</h2>

<p>Diberikan sebuah captured packet data (.pcap) yang berisi banyak paket usb. Filter:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>USB Transfer Type == 0x01
Frame Length == 72
Lalu, extract USB Data.
</code></pre></div></div>

<p>Extract dengan command</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>tshark <span class="nt">-r</span> monitor_snif.pcapng <span class="nt">-Y</span> <span class="s1">'usb.transfer_type == 0x01 &amp;&amp; frame.len == 72'</span> <span class="nt">-T</span> fields <span class="nt">-e</span> usb.capdata <span class="o">&gt;</span> usb-data.txt

<span class="nv">$ </span><span class="nb">cat </span>usb-data.txt | <span class="nb">head
</span>00:00:16:00:00:00:00:00
00:00:00:00:00:00:00:00
00:00:18:00:00:00:00:00
00:00:00:00:00:00:00:00
00:00:16:00:00:00:00:00
00:00:00:00:00:00:00:00
00:00:04:00:00:00:00:00
00:00:00:00:00:00:00:00
00:00:0b:00:00:00:00:00
00:00:00:00:00:00:00:00
</code></pre></div></div>

<p>Selanjutnya dilakukan mapping dengan python, berikut solvernya.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python
# coding: utf8
</span>
<span class="n">KEYBOARD_CODES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mh">0x04</span><span class="p">:[</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x05</span><span class="p">:[</span><span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x06</span><span class="p">:[</span><span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x07</span><span class="p">:[</span><span class="sh">'</span><span class="s">d</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">D</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x08</span><span class="p">:[</span><span class="sh">'</span><span class="s">e</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">E</span><span class="sh">'</span><span class="p">],</span>
    <span class="mh">0x09</span><span class="p">:[</span><span class="sh">'</span><span class="s">f</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x0A</span><span class="p">:[</span><span class="sh">'</span><span class="s">g</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">G</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x0B</span><span class="p">:[</span><span class="sh">'</span><span class="s">h</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">H</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x0C</span><span class="p">:[</span><span class="sh">'</span><span class="s">i</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">I</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x0D</span><span class="p">:[</span><span class="sh">'</span><span class="s">j</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">J</span><span class="sh">'</span><span class="p">],</span>
    <span class="mh">0x0E</span><span class="p">:[</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">K</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x0F</span><span class="p">:[</span><span class="sh">'</span><span class="s">l</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">L</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x10</span><span class="p">:[</span><span class="sh">'</span><span class="s">m</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">M</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x11</span><span class="p">:[</span><span class="sh">'</span><span class="s">n</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">N</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x12</span><span class="p">:[</span><span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">O</span><span class="sh">'</span><span class="p">],</span>
    <span class="mh">0x13</span><span class="p">:[</span><span class="sh">'</span><span class="s">p</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">P</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x14</span><span class="p">:[</span><span class="sh">'</span><span class="s">q</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Q</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x15</span><span class="p">:[</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">R</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x16</span><span class="p">:[</span><span class="sh">'</span><span class="s">s</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">S</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x17</span><span class="p">:[</span><span class="sh">'</span><span class="s">t</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">T</span><span class="sh">'</span><span class="p">],</span>
    <span class="mh">0x18</span><span class="p">:[</span><span class="sh">'</span><span class="s">u</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">U</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x19</span><span class="p">:[</span><span class="sh">'</span><span class="s">v</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">V</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x1A</span><span class="p">:[</span><span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">W</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x1B</span><span class="p">:[</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x1C</span><span class="p">:[</span><span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Y</span><span class="sh">'</span><span class="p">],</span>
    <span class="mh">0x1D</span><span class="p">:[</span><span class="sh">'</span><span class="s">z</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Z</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x1E</span><span class="p">:[</span><span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">!</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x1F</span><span class="p">:[</span><span class="sh">'</span><span class="s">2</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">@</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x20</span><span class="p">:[</span><span class="sh">'</span><span class="s">3</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">#</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x21</span><span class="p">:[</span><span class="sh">'</span><span class="s">4</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">$</span><span class="sh">'</span><span class="p">],</span>
    <span class="mh">0x22</span><span class="p">:[</span><span class="sh">'</span><span class="s">5</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">%</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x23</span><span class="p">:[</span><span class="sh">'</span><span class="s">6</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">^</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x24</span><span class="p">:[</span><span class="sh">'</span><span class="s">7</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">&amp;</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x25</span><span class="p">:[</span><span class="sh">'</span><span class="s">8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">*</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x26</span><span class="p">:[</span><span class="sh">'</span><span class="s">9</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">(</span><span class="sh">'</span><span class="p">],</span>
    <span class="mh">0x27</span><span class="p">:[</span><span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">)</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x28</span><span class="p">:[</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">],</span>   <span class="mh">0x2C</span><span class="p">:[</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x2D</span><span class="p">:[</span><span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x2E</span><span class="p">:[</span><span class="sh">'</span><span class="s">=</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">+</span><span class="sh">'</span><span class="p">],</span>
    <span class="mh">0x2F</span><span class="p">:[</span><span class="sh">'</span><span class="s">[</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">{</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x30</span><span class="p">:[</span><span class="sh">'</span><span class="s">]</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">}</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x32</span><span class="p">:[</span><span class="sh">'</span><span class="s">#</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">~</span><span class="sh">'</span><span class="p">],</span>     <span class="mh">0x33</span><span class="p">:[</span><span class="sh">'</span><span class="s">;</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">:</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x34</span><span class="p">:[</span><span class="sh">'</span><span class="se">\'</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'"'</span><span class="p">],</span>   
    <span class="mh">0x36</span><span class="p">:[</span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">&lt;</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x37</span><span class="p">:[</span><span class="sh">'</span><span class="s">.</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">&gt;</span><span class="sh">'</span><span class="p">],</span>    <span class="mh">0x38</span><span class="p">:[</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">?</span><span class="sh">'</span><span class="p">],</span>
<span class="p">}</span>

<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">usb-data.txt</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">usb_data</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>

<span class="n">usb_data</span> <span class="o">=</span> <span class="n">usb_data</span><span class="p">.</span><span class="nf">split</span><span class="p">()</span>
<span class="n">extracted_data</span> <span class="o">=</span> <span class="sh">""</span>

<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">usb_data</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">:</span><span class="sh">'</span><span class="p">)</span>
    
    <span class="n">upp</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">upp</span><span class="p">:</span>
            <span class="n">extracted_data</span> <span class="o">+=</span> <span class="n">KEYBOARD_CODES</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">extracted_data</span> <span class="o">+=</span> <span class="n">KEYBOARD_CODES</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="nf">print</span><span class="p">(</span><span class="n">extracted_data</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python solver_snif.py 
susah ya nyari flags nya ? ini lho flags nya : icyptiion<span class="o">{</span>Ww1r3sh4rk_n0t_only_f0r_n3tw0rks<span class="o">}</span> <span class="nb">.</span> kettemu kan 
</code></pre></div></div>

<p>Hilangkan huruf w menjadi W1r3sh4rk dan perbaiki format flag, didapatkan flag yang benar.</p>

<h3 id="flag-4">Flag</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>icyption{W1r3sh4rk_n0t_only_f0r_n3tw0rks}
</code></pre></div></div>

<h2 id="any-information-on-this-website">Any Information On This Website</h2>

<p>Diberikan link menuju website, klik button LOGIN agar diarahkan ke halaman login. Cek source dengan CTRL+U. Didapatkan teks yang ter-encode base64 <code class="language-plaintext highlighter-rouge">VkhKNUlHZDFaWE4wTDJkMVpYTjBDZz09Cg==</code></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo </span><span class="nv">VkhKNUlHZDFaWE4wTDJkMVpYTjBDZz09Cg</span><span class="o">==</span> | <span class="nb">base64</span> <span class="nt">-d</span> | <span class="nb">base64</span> <span class="nt">-d</span>
Try guest/guest
</code></pre></div></div>

<p>Login dengan credential yang didapat, lalu didapati clue selanjutnya pada konten halaman.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>it's cool that you logged in, but unfortunately we can only give the next clue to 'administrator'. :(
</code></pre></div></div>

<p>Cek cookie pada website, ditemukan cookie auth yang terdapat <code class="language-plaintext highlighter-rouge">username=guest</code> dimana merupakan credential untuk login tadi.</p>

<p>Ubah cookie guest menjadi administrator (disini saya menggunakan ekstensi <code class="language-plaintext highlighter-rouge">EditThisCookie</code> pada Chrome). Refresh halaman dan didapatkan informasi mengenai website.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Congratulations, you're the administrator!
I made this website using there tools
- php
- visual studio code
- git
- apache
</code></pre></div></div>

<p>Akses folder git pada http://180.250.135.6:8080/.git/ dan menampilkan 403 Forbidden yang mana kita tidak diberi akses menuju path tersebut.</p>

<p>Dump git dengan GitTools.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./gitdummper.sh http://180.250.135.6:8080/.git/ out
</code></pre></div></div>

<p>Didapatkan flag pada file config.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-r</span> <span class="s1">'icyption{.*}'</span>
.git/config:	<span class="c">#icyption{1N1_kaN_Y4Ng_kaMu_Cari_h3he}</span>
</code></pre></div></div>

<h3 id="flag-5">Flag</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>icyption{1N1_kaN_Y4Ng_kaMu_Cari_h3he}
</code></pre></div></div>

<h2 id="hannah-needs-your-help">Hannah Needs Your Help</h2>

<p>Diberikan list angka desimal, hasil enkripsi per-huruf flag dengan RSA. Diketahui nilai N = 143. Karena N kecil, penulis dapat langsung mengetahui faktor prima p dan q yaitu 11 dan 13.</p>

<p>Atau dengan menggunakan factordb.com untuk mencari prima p dan q.</p>

<p>Dilakukan bruteforce nilai e dari 0-65537 karena e belum diketahui. Berikut solvernya.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/python2</span>
<span class="c"># -*- coding: utf8 -*-</span>

from Crypto.Util.number import <span class="k">*</span>
import gmpy2

cipher <span class="o">=</span> <span class="o">[</span>
    118, 44, 121, 18, 129, 118, 45, 33, 7, 21, 116, 21, 13, 33, 38, 17, 49, 13, 100, 13, 17, 49, 13, 100, 13, 17, 80, 39, 80, 13, 91, 17, 50, 39, 38, 13, 5
<span class="o">]</span>

p <span class="o">=</span> 11 <span class="p">;</span> q <span class="o">=</span> 13
n <span class="o">=</span> p <span class="k">*</span> q
t <span class="o">=</span> <span class="o">(</span>p - 1<span class="o">)</span> <span class="k">*</span> <span class="o">(</span>q - 1<span class="o">)</span>

<span class="k">for </span>e <span class="k">in </span>range<span class="o">(</span>2, 0x10001<span class="o">)</span>:
    d <span class="o">=</span> gmpy2.invert<span class="o">(</span>e, t<span class="o">)</span>
    
    flag <span class="o">=</span> <span class="s1">''</span>
    <span class="k">for </span>c <span class="k">in </span>cipher:
        flag +<span class="o">=</span> chr<span class="o">(</span>pow<span class="o">(</span>c, d, n<span class="o">))</span>
    
    <span class="k">if </span>flag.startswith<span class="o">(</span><span class="s1">'icyption'</span><span class="o">)</span>:
        print <span class="s1">'Found exponent = %d'</span> % e
        print <span class="s1">'Flag = %s'</span> % flag
        <span class="nb">break</span>
</code></pre></div></div>

<p>Jalankan dan didapatkan flag.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python solver_encryption.py 
Found exponent <span class="o">=</span> 7
Flag <span class="o">=</span> icyption<span class="o">{</span>m3m4ng_r4d4_r4d4_sus4h_jug4<span class="o">}</span>
</code></pre></div></div>

<h3 id="flag-6">Flag</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>icyption{m3m4ng_r4d4_r4d4_sus4h_jug4}
</code></pre></div></div>

<h2 id="canary-birds">Canary Birds</h2>

<p>Awalnya hanya diberikan service nc saja tidak ada file binary-nya sampai ada yang tanya jurinya. Akhirnya file binary-nya dibagi, dan didalamnya terdapat flag XD.</p>

<p>Tetapi disini penulis mengerjakan seperti apa yang dikatakan juri.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python <span class="nt">-c</span> <span class="s1">'print "A"*17'</span> | ./source 
saya akan mengulang perkataan ada. masukkan karakter! anda memasukkan : AAAAAAAAAAAAAAAAA

<span class="nv">$ </span>python <span class="nt">-c</span> <span class="s1">'print "A"*18'</span> | ./source 
saya akan mengulang perkataan ada. masukkan karakter! anda memasukkan : AAAAAAAAAAAAAAAAAA

<span class="nv">$ </span>python <span class="nt">-c</span> <span class="s1">'print "A"*20'</span> | ./source 
saya akan mengulang perkataan ada. masukkan karakter! ERROR! karaktermu kepanjangan!
</code></pre></div></div>

<p>Ditemukan pada saat input 20 karakter, program menampikan error. Selanjutnya dilakukan bruteforce karakter (yang dimaksud seperti canary) dan didapatkan flag ketika karakter ke-21 adalah %.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python canary.py 
<span class="o">[</span>... REDACTED ...]
<span class="o">[!]</span> Byte 34 fail :<span class="o">(</span>
<span class="o">[!]</span> Byte 35 fail :<span class="o">(</span>
<span class="o">[!]</span> Byte 36 fail :<span class="o">(</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Found correct byte <span class="o">=</span> 37
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Flag <span class="o">=</span> icyption<span class="o">{</span>m4u_d4p3t_b34s1sw4<span class="o">}</span>
</code></pre></div></div>

<p>Berikut solvernya.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python
</span>
<span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">"</span><span class="s">warn</span><span class="sh">"</span>

<span class="k">def</span> <span class="nf">shot</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nf">process</span><span class="p">(</span><span class="sh">'</span><span class="s">./source</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="sh">"</span><span class="s">! </span><span class="sh">"</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">.</span><span class="nf">recv</span><span class="p">()</span>
        
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nf">shot</span><span class="p">(</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="mh">0x14</span> <span class="o">+</span> <span class="nf">chr</span><span class="p">(</span><span class="n">byte</span><span class="p">))</span>
        <span class="k">if</span> <span class="sh">'</span><span class="s">ERROR</span><span class="sh">'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
            <span class="k">print</span> <span class="sh">'</span><span class="s">[*] Found correct byte = %d</span><span class="sh">'</span> <span class="o">%</span> <span class="n">byte</span>
            <span class="k">print</span> <span class="sh">'</span><span class="s">[*] Flag = </span><span class="sh">'</span> <span class="o">+</span> <span class="n">out</span><span class="p">[</span><span class="n">out</span><span class="p">.</span><span class="nf">index</span><span class="p">(</span><span class="sh">'</span><span class="s">icyption</span><span class="sh">'</span><span class="p">):]</span>
            <span class="k">break</span>
        <span class="k">print</span> <span class="sh">'</span><span class="s">[!] Byte %d fail :(</span><span class="sh">'</span> <span class="o">%</span> <span class="n">byte</span>
</code></pre></div></div>

<h3 id="flag-7">Flag</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>icyption{m4u_d4p3t_b34s1sw4}
</code></pre></div></div>

<p>Berikut hasil decompile binary menggunakan IDA.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax@2</span>
    <span class="kt">char</span> <span class="n">src</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="c1">// [sp+10h] [bp-90h]@1</span>
    <span class="kt">char</span> <span class="n">buffer</span><span class="p">;</span> <span class="c1">// [sp+30h] [bp-70h]@1</span>
    <span class="kt">char</span> <span class="n">correct_byte</span><span class="p">;</span> <span class="c1">// [sp+44h] [bp-5Ch]@1</span>
    <span class="n">_BYTE</span> <span class="n">v8</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">// [sp+45h] [bp-5Bh]@3</span>

    <span class="n">setbuf</span><span class="p">(</span><span class="n">_bss_start</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="s">"icyption{m4u_d4p3t_b34s1sw4}"</span><span class="p">);</span>
    <span class="n">correct_byte</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"saya akan mengulang perkataan ada. masukkan karakter! "</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buffer</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="mi">37</span> <span class="o">==</span> <span class="n">correct_byte</span> <span class="p">)</span>
    <span class="p">{</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">v8</span><span class="p">,</span> <span class="n">src</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"anda memasukkan : %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buffer</span><span class="p">);</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"ERROR! karaktermu kepanjangan!"</span><span class="p">);</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Admin Mistake. Seharusnya menggunakan fungsi <code class="language-plaintext highlighter-rouge">fopen()</code> dalam C untuk mendapatkan value flag. Karena kalau seperti ini malah lebih ke-reversing kata salah satu peserta.</p>

<h2 id="penutup">Penutup</h2>

<p>Masukkan untuk juri, mohon untuk melakukan testing secara teliti pada seluruh soal. Dan saya tidak tahu apakah probset ctf ini sama, karena “Any Information On This Website” merupakan soal copy dari gemastik.</p>

<p>Alhamdulillah Semoga Menang menjadi menang beneran :).</p>

<p>:helloworld:</p>

  </div><a class="u-url" href="/2020/08/07/final-icyption-2020.html" hidden></a>
</article>

      </div>
    </main></body>

</html>
